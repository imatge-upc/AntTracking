
command:
  - "srun"
  - "-c"
  - "8"
  - "--gres=gpu:4"
  - "--mem"
  - "32G"
  - "--time=10:00:00"
  - bash
  - ${program}
  - "--config-file=./fastreid_configs/Market1501/bagtricks_R50.yml"
  - "--num-gpus=4"
  - ${args_no_hyphens}

program: wandb_fast_reid.sh

method: bayes
metric:
  name: mINP
  goal: maximize

parameters:
  OUTPUT_DIR:
    value: runs/apparence/train

  INPUT.SIZE_TRAIN:
    value: "(64, 64)"
  INPUT.SIZE_TEST:
    value: "(64, 64)"
  


  INPUT.AFFINE.ENABLED:
    values: [False, True]

  INPUT.AUGMIX.ENABLED:
    values: [False, True]
  INPUT.AUGMIX.PROB:
    distribution: uniform
    min: 0.0
    max: 1

  INPUT.AUTOAUG.ENABLED:
    values: [False, True]
  INPUT.AUTOAUG.PROB:
    distribution: uniform
    min: 0.0
    max: 1

  INPUT.CJ.ENABLED:
    values: [False, True]
  INPUT.CJ.PROB:
    distribution: uniform
    min: 0.0
    max: 1
  INPUT.CJ.BRIGHTNESS:
    distribution: uniform
    min: 0.0
    max: 1
  INPUT.CJ.CONTRAST:
    distribution: uniform
    min: 0.0
    max: 1
  INPUT.CJ.HUE:
    distribution: uniform
    min: 0.0
    max: 1
  INPUT.CJ.SATURATION:
    distribution: uniform
    min: 0.0
    max: 1

  INPUT.CROP.ENABLED:
    value: False
  INPUT.CROP.RATIO:
    value: "(0., 1.)"
  INPUT.CROP.SCALE:
    value: "(0., 1)"
  INPUT.CROP.SIZE:
    value: "(64, 64)"

  INPUT.FLIP.ENABLED:
    value: True
  INPUT.FLIP.PROB:
    value: 0.5

  INPUT.PADDING.ENABLED:
    value: True
  INPUT.PADDING.MODE:
    value: "constant"
  INPUT.PADDING.SIZE:
    distribution: int_uniform
    min: 1
    max: 10

  INPUT.REA.ENABLED:
    values: [False, True]
  INPUT.REA.PROB:
    distribution: uniform
    min: 0.0
    max: 1
  INPUT.REA.VALUE:
    value: "(123.675, 116.28, 103.53)"

  INPUT.RPT.ENABLED:
    values: [False, True]
  INPUT.RPT.PROB:
    distribution: uniform
    min: 0.0
    max: 1

  MODEL.LOSSES.CE.ALPHA:
    value: 0.2
  MODEL.LOSSES.CE.EPSILON:
    value: 0.1
  MODEL.LOSSES.CE.SCALE:
    value: 1.0

  MODEL.LOSSES.TRI.HARD_MINING:
    value: True
  MODEL.LOSSES.TRI.NORM_FEAT:
    value: False
  MODEL.LOSSES.TRI.MARGIN:
    distribution: uniform
    min: 0.0
    max: 0.3
  MODEL.LOSSES.TRI.SCALE:
    value: 1.0

  MODEL.PIXEL_MEAN:
    value: "(123.675, 116.28, 103.53)"
  MODEL.PIXEL_STD:
    value: "(58.395, 57.12, 57.375)"

  MODEL.QUEUE_SIZE:
    value: 8192

  SOLVER.AMP.ENABLED:
    values: [False, True]

  SOLVER.MAX_EPOCH:
    value: 4320
  SOLVER.BASE_LR:
    distribution: uniform
    max: 0.01
    min: 0.0001
  SOLVER.BIAS_LR_FACTOR:
    value: 1.0

  SOLVER.CLIP_GRADIENTS.ENABLED:
    values: [False, True]
  SOLVER.CLIP_GRADIENTS.CLIP_TYPE:
    value: "norm"
  SOLVER.CLIP_GRADIENTS.CLIP_VALUE:
    value: 5.0
  SOLVER.CLIP_GRADIENTS.NORM_TYPE:
    value: 2.0

  SOLVER.DELAY_EPOCHS:
    value: 2000
  SOLVER.FREEZE_ITERS:
    value: 0

  SOLVER.GAMMA:
    value: 0.1

  SOLVER.HEADS_LR_FACTOR:
    value: 1.0

  SOLVER.IMS_PER_BATCH:
    value: 64

  SOLVER.MOMENTUM:
    distribution: uniform
    max: 0.95
    min: 0.9

  SOLVER.NESTEROV:
    value: False

  SOLVER.OPT:
    values: ["Adam", "SGD"]

  SOLVER.SCHED:
    value: "CosineAnnealingLR"
  SOLVER.ETA_MIN_LR:
    value: 0.0000007

  SOLVER.WARMUP_FACTOR:
    value: 0.1
  SOLVER.WARMUP_ITERS:
    value: 2000
  SOLVER.WARMUP_METHOD:
    value: "linear"

  SOLVER.WEIGHT_DECAY:
    value: 0.0005
  SOLVER.WEIGHT_DECAY_BIAS:
    value: 0.0005
  SOLVER.WEIGHT_DECAY_NORM:
    value: 0.0005
  
  TEST.FLIP.ENABLED:
    value: False
  
  TEST.ROC.ENABLED:
    value: False

  TEST.IMS_PER_BATCH:
    value: 128
